Plan all the way to the end.